if(!PHP2Go.included[PHP2Go.baseUrl+'form/tinymcefield.js']){PHP2Go.include(PHP2Go.baseUrl+'vendor/tinymce/jscripts/tiny_mce/tiny_mce.js');TinyMCEField=function(fld,params){this.ComponentField(fld,'TinyMCEField');this.mce=null;this.mustFocus=false;this.readOnly=false;this.type='iframe';this.setup(params);};TinyMCEField.extend(ComponentField,'ComponentField');TinyMCEField.prototype.setup=function(params){this.fld.component=this;var self=this;if(params.readonly){this.readOnly=true;params.readonly=0;}params.oninit=function(){self.mce=tinyMCE.get(self.fld.id);self.mce.iframe=self.mce.contentAreaContainer.firstChild;self.mce.toolbars=$(self.mce.editorContainer).getElementsByClassName('mceToolbar');if(self.fld.disabled||self.readOnly){self.setReadOnly(true);}else{if(self.mustFocus){self.mce.focus();self.mustFocus=false;}}};tinyMCE.init(params);};TinyMCEField.prototype.getValue=function(){return this.mce.getContent();};TinyMCEField.prototype.getValueAsText=function(){var ml=RegExp.multiline;var text=this.getValue().stripTags().replace('&nbsp;',' ');RegExp.multiline=ml;return text;};TinyMCEField.prototype.setValue=function(html){this.mce.setContent(html);};TinyMCEField.prototype.insertHTML=function(html){tinyMCE.execCommand('mceInsertContent',false,html);};TinyMCEField.prototype.clear=function(){this.mce.setContent('');};TinyMCEField.prototype.isEmpty=function(){var re=/<(img|input|hr)/i;var html=this.getValue();var text=this.getValueAsText().trim();return(text==""&&!re.test(html));};TinyMCEField.prototype.setReadOnly=function(ro,tb){var mce=this.mce,dom=tinymce.DOM,d=mce.getDoc();var tb=(typeof(tb)=='undefined'?true:!!tb);var tbl=mce.getContainer().firstChild;if(ro){if(!tinymce.isIE){try{d.designMode='Off';}catch(e){}}else{var b=mce.getBody();DOM.hide(b);b.contentEditable=false;DOM.show(b);}if(tb){var h=tbl.offsetHeight;for(var i=0;i<mce.toolbars.length;i++)mce.toolbars[i].style.display='none';mce.iframe.style.height=h+'px';}}else{if(!tinyMCE.isIE){try{d.designMode='On';}catch(e){}}else{var b=mce.getBody();DOM.hide(b);b.contentEditable=true;DOM.show(b);}if(tb){var h=mce.iframe.offsetHeight;for(var i=0;i<mce.toolbars.length;i++)mce.toolbars[i].style.display='';mce.iframe.style.height=(h-(tbl.offsetHeight-h))+'px';}}};TinyMCEField.prototype.setDisabled=function(b){if(b){this.setReadOnly(true);}else{if(!this.readOnly){this.setReadOnly(false);}else{var mce=this.mce,tbl=mce.getContainer().firstChild;var h=mce.iframe.offsetHeight;for(var i=0;i<mce.toolbars.length;i++)mce.toolbars[i].style.display='';mce.iframe.style.height=(h-(tbl.offsetHeight-h))+'px';}}this.fld.disabled=b;};TinyMCEField.prototype.focus=function(){if(this.mce)this.mce.focus(false);else this.mustFocus=true;};TinyMCEField.prototype.serialize=function(){this.mce.save();if(this.fld.value!='')return this.name+'='+this.fld.value.urlEncode();return null;};PHP2Go.included[PHP2Go.baseUrl+'form/tinymcefield.js']=true;}