if(!PHP2Go.included[PHP2Go.baseUrl+'widgets/googlemap.js']){function GoogleMap(attrs,func){this.Widget(attrs,func);var apiOk;try{apiOk=GBrowserIsCompatible();}catch(e){apiOk=false;}this.container=$(this.attributes.id);this.map=(apiOk?new GMap2(this.container):null);}GoogleMap.extend(Widget,'Widget');GoogleMap.instances={};GoogleMap.events=['addmaptype','removemaptype','click','dblclick','singlerightclick','movestart','move','moveend','zoomend','maptypechanged','infowindowopen','infowindowbeforeclose','infowindowclose','addoverlay','removeoverlay','clearoverlays','mouseover','mouseout','mousemove','dragstart','drag','dragend','load'];GoogleMap.prototype.setup=function(){if(this.map){var self=this,map=this.map,attrs=this.attributes;var info=$(attrs.id+'_locations').getElementsByTagName('div');var bounds=new GLatLngBounds(),locations=[];for(var i=0;i<attrs.locations.length;i++){var pnt=new GLatLng(attrs.locations[i].lat,attrs.locations[i].lng);bounds.extend(pnt);locations.push(pnt);}attrs.controls.walk(function(ctrl,idx){var zoomExists=false;switch(ctrl.toLowerCase()){case'maptype':map.addControl(new GMapTypeControl());break;case'smallmap':if(!zoomExists){map.addControl(new GSmallMapControl());zoomExists=true;}break;case'largemap':if(!zoomExists){map.addControl(new GLargeMapControl());zoomExists=true;}break;case'smallzoom':if(!zoomExists){map.addControl(new GSmallZoomControl());zoomExists=true;}break;case'scale':map.addControl(new GScaleControl());break;case'overviewmap':map.addControl(new GOverviewMapControl());break;}});map.setCenter(new GLatLng(attrs.center.lat,attrs.center.lng));if(attrs.zoom||attrs.locations.length>0)map.setZoom(attrs.zoom||map.getBoundsZoomLevel(bounds));else map.setZoom(8);switch(attrs.type){case'normal':map.setMapType(G_NORMAL_MAP);break;case'satellite':map.setMapType(G_SATELLITE_MAP);break;case'hybrid':map.setMapType(G_HYBRID_MAP);break;}if(!attrs.draggable)map.disableDragging();locations.walk(function(item,idx){var marker=new GMarker(item,{title:attrs.locations[idx].title||null,draggable:self.attributes.draggableMarkers });if(!info[idx].innerHTML.empty())marker.bindInfoWindow(info[idx]);map.addOverlay(marker);});this.raiseEvent('init');Event.addListener(window,'unload',GUnload);}GoogleMap.instances[this.attributes.id]=this;};GoogleMap.prototype.addEventListener=function(name,func,scope,unshift){name=name.toLowerCase().replace(/^on/,'');if(GoogleMap.events.indexOf(name)!=-1){if(this.map)GEvent.bind(this.map,name,scope||this,func);}else{GoogleMap.superclass.addEventListener.apply(this,arguments);}};GoogleMap.prototype.bindListener=function(obj,name,func,scope){GEvent.bind(obj,name,scope||this,func);};GoogleMap.prototype.addMarker=function(point,opts,center,zoom){opts=Object.extend({draggable:true},(opts||{}));var marker=new GMarker(point,opts);if(opts.info)marker.bindInfoWindowHtml(opts.info);if(!!center)this.map.setCenter(point);if(zoom>0)this.map.setZoom(zoom);this.map.addOverlay(marker);return marker;};GoogleMap.prototype.clear=function(){this.map.clearOverlays();};GoogleMap.prototype.findAddress=function(address,callback){var geocoder=new GClientGeocoder();if(geocoder)geocoder.getLatLng(address,callback);};PHP2Go.included[PHP2Go.baseUrl+'widgets/googlemap.js']=true;}