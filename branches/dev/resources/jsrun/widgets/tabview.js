if(!PHP2Go.included[PHP2Go.baseUrl+'widgets/tabview.js']){function TabView(attrs,func){this.Widget(attrs,func);this.root=null;this.navContainer=null;this.contentContainer=null;this.activeTab=null;this.tabs=[];}TabView.extend(Widget,'Widget');TabView.instances={};TabView.prototype.setup=function(){this.root=$(this.attributes['id']);this.navContainer=this.root.getElementsByTagName('ul')[0];this.contentContainer=this.root.getElementsByClassName('tabContainer')[0];var navItems=this.navContainer.getElementsByTagName('li');for(var i=0;i<this.attributes['tabs'].length;i++){var panel=new TabPanel(this.attributes['tabs'][i]);panel.labelEl=$E(navItems[i]);panel.parent=this;panel.setup();this.tabs.push(panel);Event.addListener(navItems[i],'click',this._clickHandler.bind(this));}this.setActiveIndex(this.attributes['activeIndex']);TabView.instances[this.attributes['id']]=this;this.raiseEvent('init');};TabView.prototype.addTab=function(tab,idx){if(tab instanceof TabPanel&&tab.hasAttributes('id','caption')){tab.parent=this;var before=this.getTabByIndex(idx);var nav=this.navContainer,cont=this.contentContainer;var li=$N('li');tab.labelEl=li;var a=$N('a',li);a.href='javascript:;';if(!tab.isEnabled())a.setAttribute('disabled',true);var span=$N('em',a);span.innerHTML=tab.attributes['caption'];var div=$N('div');div.id=tab.attributes['id'];if(before){nav.insertBefore(li,before.labelEl);cont.insertBefore(div,before.contentEl);this.tabs.splice(idx-1,0,tab);}else{nav.appendChild(li);cont.appendChild(div);this.tabs.push(tab);}tab.setup();if(tab.isActive())this.setActiveTab(tab);Event.addListener(li,'click',this._clickHandler.bind(this));}};TabView.prototype.removeTabByIndex=function(idx){this.removeTab(this.getTabByIndex(idx));};TabView.prototype.removeTab=function(tab){if(tab instanceof TabPanel&&tab.parent==this){if(!this.raiseEvent('beforeremove',[tab]))return;var idx=this.getTabIndex(tab);if(tab==this.activeTab){var found=false;for(var i=this.activeIndex+1;i<=this.tabs.length;i++){if(this.tabs[i-1].isEnabled()){this.setActiveTab(this.tabs[i-1]);found=true;break;}}if(!found){for(var i=this.activeIndex-1;i>0;i--){if(this.tabs[i-1].isEnabled()){this.setActiveTab(this.tabs[i-1]);break;}}}}Event.removeListener(tab.labelEl,'click',this._clickHandler.bind(this));this.navContainer.removeChild(tab.labelEl);this.contentContainer.removeChild(tab.contentEl);this.tabs.splice(idx-1,1);this.raiseEvent('afterremove',[tab]);}};TabView.prototype.getTabIndex=function(tab){for(var i=0;i<this.tabs.length;i++){if(this.tabs[i]==tab)return(i+1);}return-1;};TabView.prototype.getTabByIndex=function(idx){if(idx>=1&&idx<=this.tabs.length)return this.tabs[idx-1];return null;};TabView.prototype.getTabById=function(id){for(var i=0;i<this.tabs.length;i++){if(this.tabs[i].attributes['id']==id)return this.tabs[i];}return null;};TabView.prototype.getActiveIndex=function(){return this.activeIndex;};TabView.prototype.setActiveIndex=function(idx){this.setActiveTab(this.getTabByIndex(idx));};TabView.prototype.getActiveTab=function(){return this.tabs[this.activeIndex-1];};TabView.prototype.setActiveTab=function(tab){if(tab instanceof TabPanel&&tab.isEnabled()&&tab!=this.activeTab){if(!this.raiseEvent('beforechange',[this.activeTab,tab]))return;if(this.activeTab)this._changeActiveState(this.activeTab,false);this._changeActiveState(tab,true);this.raiseEvent('afterchange',[this.activeTab,tab]);this.activeIndex=this.getTabIndex(tab);this.activeTab=tab;}};TabView.prototype._changeActiveState=function(tab,state){var nc=tab.labelEl.classNames();var ec=tab.contentEl.classNames();if(state){nc.add('tabViewSelected');ec.add('tabViewVisible');tab.labelEl.scrollIntoView(false);tab.raiseEvent('activate');}else{nc.remove('tabViewSelected');ec.remove('tabViewVisible');tab.raiseEvent('deactivate');}tab.attributes['active']=state;};TabView.prototype._clickHandler=function(e){var elm=this.root,e=$EV(e);var trg=e.element(),tabs=this.tabs;for(var i=0;i<tabs.length;i++){if(Element.isChildOf(trg,tabs[i].labelEl)){this.setActiveTab(tabs[i]);break;}}};function TabPanel(attrs){this.Widget(attrs,null);this.labelEl=null;this.contentEl=null;this.parent=null;this.attributes['disabled']=!!this.attributes['disabled'];this.attributes['active']=!!this.attributes['active'];}TabPanel.extend(Widget,'Widget');TabPanel.prototype.setup=function(){this.contentEl=$(this.attributes['id']);this.contentEl.tab=this;};TabPanel.prototype.getIndex=function(){return this.parent.getTabIndex(this);};TabPanel.prototype.activate=function(){this.parent.setActiveTab(this);};TabPanel.prototype.isActive=function(){return(this.attributes['active']&&this.parent.activeTab==this);};TabPanel.prototype.enable=function(){this.attributes['disabled']=false;this.labelEl.firstChild.removeAttribute('disabled');};TabPanel.prototype.disable=function(){this.attributes['disabled']=true;this.labelEl.firstChild.setAttribute('disabled',true);};TabPanel.prototype.isEnabled=function(){return(this.attributes['disabled']==false);};TabPanel.prototype.setContent=function(code,evalScripts){if(typeof(code)=='string')this.contentEl.update(code,evalScripts);};PHP2Go.included[PHP2Go.baseUrl+'widgets/tabview.js']=true;}